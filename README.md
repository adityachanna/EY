Here is the comprehensive, code-aligned `README.md` for **Aetheria**, tailored to the codebase you provided (specifically `route.py`, `final.py`, `market_agents.py`, etc.) and the requirements of EY Techathon 6 PS 1.


# Aetheria — Pharmaceutical Strategic Intelligence Orchestrator

**Submission for EY Techathon 6 | Problem Statement 1: Pharmaceutical Strategy**

**Aetheria** is a production-ready, multi-agent system designed to revolutionize strategic decision-making in the pharmaceutical industry. By orchestrating a hybrid architecture of **Deep Research Agents** (for comprehensive reports) and **Lite Agents** (for rapid insights), Aetheria automates the analysis of drug repurposing, market viability, supply chain risks, and patent landscapes.

---

## Table of Contents

- [Overview](#overview)
- [Architecture](#architecture)
- [Agent Ecosystem](#agent-ecosystem)
  - [The Router (Session Manager)](#the-router-session-manager)
  - [Deep Research Agent](#deep-research-agent)
  - [Lite Agent](#lite-agent)
  - [Specialized Worker Agents](#specialized-worker-agents)
- [Tech Stack](#tech-stack)
- [Installation & Setup](#installation--setup)
- [Configuration](#configuration)
- [Usage & API](#usage--api)
- [Project Structure](#project-structure)
- [Contributing](#contributing)

---

## Overview

In the high-stakes world of pharmaceuticals, decision-makers need both instant answers and deep, rigorous analysis. Aetheria solves this by implementing a **Session-Based Routing Layer** that dynamically switches between:

1.  **Deep Research Mode:** A slow-thinking, deliberate orchestrator that generates comprehensive, multi-section strategic dossiers (e.g., "Assess Minocycline repurposing for CNS indications").
2.  **Lite Mode:** A fast-thinking responder that queries existing internal knowledge and live web data for immediate facts (e.g., "What is the CAGR of the depression market?").

**Key Capabilities:**
* **Drug Repurposing Triage:** Validates scientific rationale, clinical evidence, and commercial viability.
* **Hybrid Data Fusion:** Seamlessly blends **Mock Enterprise Data** (IQVIA, EXIM, Internal DB) with **Real-World Live Data** (PubMed, Tavily Search).
* **Automated Visualization:** Generates Python-based charts (Seaborn/Matplotlib) on the fly.
* **Internal RAG:** Ingests and retrieves insights from secure internal PDFs and documents.

---

## Architecture

Aetheria uses a hub-and-spoke architecture managed by a `RouteLayer` built on **FastAPI**.

```mermaid
graph TD
    User[User Query] --> API[FastAPI / Route Layer]
    API --> Session{Session Logic}
    
    Session -- First Query/Complex --> Deep[Deep Research Agent]
    Session -- Follow-up/Simple --> Lite[Lite Agent]
    
    subgraph "Deep Agent Ecosystem (LangGraph)"
        Deep --> Orchestrator[Master Orchestrator]
        Orchestrator --> PubMed[PubMed Agent]
        Orchestrator --> IQVIA[IQVIA Market Agent]
        Orchestrator --> EXIM[Supply Chain Agent]
        Orchestrator --> Patent[Patent Agent]
        Orchestrator --> Clinical[Clinical Trials Agent]
        Orchestrator --> Internal[Internal Knowledge RAG]
        Orchestrator --> Viz[Visualization Agent]
        Orchestrator --> Web[Web Intelligence]
    end
    
    subgraph "Lite Agent Ecosystem"
        Lite --> MarkdownKB[Generated Reports]
        Lite --> WebSearch[Tavily Search]
    end


-----

## Agent Ecosystem

### The Router (Session Manager)

Located in `agents/route.py`.

  - **Function:** Tracks conversation history via `session_id`.
  - **Logic:** Routes the initial broad query to the **Deep Agent** to generate a foundation of knowledge. Subsequent queries in the same session are routed to the **Lite Agent**, which answers from the context of the generated report + web search.

### Deep Research Agent

Located in `agents/final.py`.

  - **Role:** The "Brain". It follows a strict system prompt to produce structured, citation-backed strategic reports.
  - **Backend:** Powered by `deepagents` and `ChatOpenAI` (e.g., Grok/GPT-4o via OpenRouter).
  - **Output:** Markdown reports saved to disk + Base64 encoded visualizations.

### Lite Agent

Located in `agents/lite.py`.

  - **Role:** The "Assistant".
  - **Knowledge Source:** It reads the markdown files generated by the Deep Agent in the `output/` directory as its primary knowledge base. It falls back to `internet_search` only if the answer isn't in the report.

### Specialized Worker Agents

These agents are tools available to the Deep Agent, defined in `agents/market_agents.py`, `agents/pubmed_tool.py`, etc.

| Agent Name | Description | Data Source |
| :--- | :--- | :--- |
| **PubMed Agent** | Searches biomedical literature for mechanisms and efficacy. | **Real:** BioPython / NCBI Entrez API |
| **IQVIA Insights** | Market sizing, CAGR, and competitor analysis. | **Mock:** `MockIQVIA` Class |
| **EXIM Trends** | Supply chain, import/export volumes, and api sourcing. | **Mock:** `MockEXIM` Class |
| **Patent Landscape** | FTO analysis, patent expiry, and filing status. | **Mock:** `MockUSPTO` Class |
| **Clinical Trials** | Analysis of ongoing, completed, and failed trials. | **Mock:** `MockClinicalTrials` Class |
| **Web Intelligence** | Real-time news, guidelines, and patient sentiment. | **Real:** Tavily Search API |
| **Internal Knowledge** | RAG over company PDFs (BOMs, Strategy Decks). | **Real:** Pinecone + Gemini Embeddings |
| **Visualization** | Writes and executes Python code to plot charts. | **Real:** Matplotlib / Seaborn |

-----

## Tech Stack

  * **Framework:** Python 3.10+, FastAPI
  * **Orchestration:** LangChain, LangGraph, DeepAgents
  * **LLMs:** \* **OpenRouter (x-ai/grok-4.1-fast)** for Deep Orchestration.
      * **Groq (Moonshot/Kimi)** for Sub-agents (Market, Internal).
      * **Google Gemini** for Lite Agent & Embeddings.
  * **Vector Database:** Pinecone
  * **Tools:** Tavily (Web), BioPython (PubMed)
  * **Data Processing:** Pandas, NumPy, PyPDF

-----

## Installation & Setup

### 1\. Clone the Repository

```bash
git clone [https://github.com/adityachanna/Aetheria.git](https://github.com/adityachanna/Aetheria.git)
cd Aetheria
```

### 2\. Create Virtual Environment

```bash
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
```

### 3\. Install Dependencies

```bash
pip install -r requirement.txt
```

### 4\. Set Environment Variables

Create a `.env` file in the root directory. You will need keys for the various AI providers utilized by the agents.

```ini
# .env file

# API Keys
OPENROUTER_API_KEY=sk-or-...        # For Deep Agent Orchestrator
API_4=...                           # Google Gemini API Key (Embeddings/Lite)
TAVILY_API_KEY=tvly-...             # Web Search
PINECONE_API_KEY=...                # Vector DB
groq=...                            # Groq API Key (Worker Agents)
visual_groq=...                     # Groq Key for Visualization Agent
ENTREZ_EMAIL=your@email.com         # For PubMed Access

# Configuration
LANGGRAPH_ENDPOINT=http://localhost:8000
```

-----

## Usage & API

Aetheria exposes a FastAPI interface. You can run it locally for testing or development.

### Start the Server

```bash
python agents/route.py serve
```

*Server will start at `http://0.0.0.0:8000`*

### API Endpoints

#### 1\. Ingest Documents (RAG)

Upload internal PDFs (Company Docs, Minutes of Meeting) to the knowledge base.

  * **POST** `/api/ingest`
  * **Body:** `file` (Multipart/form-data)

#### 2\. Query (Standard)

Submit a strategic query.

  * **POST** `/api/query`
  * **JSON Body:**
    ```json
    {
      "query": "Assess Minocycline repurposing for neurological disorders.",
      "session_id": "optional-custom-id"
    }
    ```

#### 3\. Query (Streaming)

Receive real-time updates on the agent's thought process and tool usage.

  * **POST** `/api/query/stream`

### Example Workflow via Python Client

See `agents/example_client.py` for a full implementation.

```python
from agents.example_client import ResearchAgentClient

client = ResearchAgentClient()
session_id = client.create_session()

# 1. Deep Dive (First query in session)
print("Running Deep Research...")
client.query("Analyze market risks for Telmisartan", use_session=True)

# 2. Quick Follow-up (Second query uses Lite Agent)
print("Asking follow up...")
client.query("What is the production capacity at Hyderabad?", use_session=True)
```

-----

## Project Structure

```text
Aetheria/
├── agents/
│   ├── final.py                # DEEP AGENT: Master Orchestrator configuration
│   ├── lite.py                 # LITE AGENT: RAG + Web Search logic
│   ├── route.py                # ROUTER: FastAPI app & Session logic
│   ├── market_agents.py        # WORKERS: IQVIA, EXIM, Patent, Trial agents
│   ├── mock_data_api.py        # DATA: Mock databases for market agents
│   ├── pubmed_tool.py          # TOOL: Real PubMed integration
│   ├── web_search.py           # TOOL: Tavily search integration
│   ├── internal_knowlege.py    # TOOL: RAG agent (Pinecone)
│   ├── ingest_docs.py          # UTIL: Document ingestion script
│   ├── visualization_agent.py  # TOOL: Python code generation for charts
│   └── example_client.py       # CLIENT: Test script
├── output/                     # Generated reports and charts
│   ├── visualizations/
│   └── final_report.md
├── requirements.txt            # Dependencies
├── .env                        # Secrets (not committed)
└── README.md                   # Documentation
```

-----

## Contributing

1.  **Fork** the repository.
2.  **Create** a feature branch (`git checkout -b feature/new-agent`).
3.  **Commit** your changes.
4.  **Push** to the branch.
5.  **Open** a Pull Request.

-----

**Team Contact:**

  * **Maintainer:** Aditya Channa
  * **Event:** EY Techathon 6

<!-- end list -->

```
```
